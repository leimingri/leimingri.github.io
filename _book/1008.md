# 假设检验

## 假设检验的基本概念

<font size=4>**（1）假设检验问题分类及思想**</font>

**①假设检验问题：**

* 依据实际问题的需要，提出原假设$H_{0}$以及相应的对立假设$H_{1}$。为了推断$H_{0}$是否正确，我们先假设$H_{0}$成立，
      在此条件下，分析样本观测值，如果小概率事件发生，我们就有理由怀疑$H_{0}$的正确性，因此拒绝接受原假设，否则就接受原假设，
      我们将上述统计推断问题称为假设检验问题。

**②假设检验的问题分为两种类型：**

* 参数假设检验：对总体分布函数中的未知参数提出某种假设，然后利用样本提供的信息对所提出的假设进行检验。

* 非参数假设检验：对总体分布函数的形式或总体的性质提出某种假设所进行的检验。

**③基本思想：**

* 小概率事件在一次试验中实际上几乎不会发生，即实际推断原理。


**例1：**某厂生产一种产品，共计1000件，按规定次品率不超过$2\%$才能出厂，现从中抽取10件进行检验，发现有3件次品，问这批产品能否出厂。

解：设这批产品的次品率为p（未知），根据样本提供的信息来推断次品率p是否超过0.02.我们先假设$p\leq 0.02$（记做$H_0$）。当$p=0.02$时，事件A={10件产品中有3件次品}的概率为$$P(A)=C_{10}^3p^3(1-p)^7\approx 0.0008$$.由此可见，在假设$p=0.02$成立的条件下，事件A的概率很小。而小概率事件在一次试验中可以认为几乎不会发生。
当$p<0.02$时，$P(A)$更小，更可以认为在一次随机抽样中不会发生。

而现在，在一次试验中事件A居然发生了，于是我们有理由认为假设不合理，拒绝假设，因此$p>0.02$，按规定，这批产品不能出厂。

上例中所提出的明确假设($H_0:p\leq 0.02$)所提出的假设称为原假设或零假设，记为$H_0$。与原假设对立的假设记为$H_1$,称为备择假设或对立假设（在例1中为$H_1:p>0.02$）。

**④步骤：**

* 先假定$H_0$成立；

* 分析样本观测值，若发生小概率事件，则怀疑作为前提的原假设$H_0$的正确性，此时拒绝原假设$H_0$（相当于接受备择假设$H_1$）；否则，大概率事件发生，没有理由拒绝$H_0$，于是接受原假设。

上述统计推断问题称为假设检验问题。

<font size=4>**（2）假设检验的基本概念**</font>

* 显著性水平

  * 在假设检验中将小概率值$\alpha (0<\alpha<1)$称为显著性水平。

* 检验统计量

  * 要检验假设$H_{0}$，需要依据样本$X_{1},X_{2},\cdots,X_{n}$适当构造的一个统计量。

* 拒绝域

  * 当检验统计量在某个区域$W$中取值时，拒绝原假设，此时称$W$为拒绝域。
 
* 接受域

  * 当检验统计量在某个区域$W$中取值时，接受原假设，此时称$W$为接受域。

**例2：**某车间生产一种零件，其长度X服从正态分布$N(\mu,{0.5}^2)$，要求标准长度为100（cm）。现从一批零件中随机抽查了9件，测得他们的长度（单位：cm）如下：

<center>99.3 100.1 99.9 99.2 99.6 99.1 99.3 100.2 99.0</center>

问能否认为这批零件不合格？（取显著性水平$\alpha=0.05$）

解：假设$H_0:\mu=\mu_0=100;H_1:\mu \neq 100.$
由于样本均值$\overline{X}$为总体均值$\mu$的无偏估计，因此$|\overline{x}-\mu|$应该比较小。于是，$\frac{|\overline{x}-\mu|}{\sigma/\sqrt{n}}$也应该比较小。因此若$\frac{|\overline{x}-\mu|}{\sigma/\sqrt{n}}$大于等于某个常数时，我们就怀疑原假设$H_0$的正确性。


由于 $u=\frac{\overline{X}-\mu_{0}}{\sigma/\sqrt{n}}\sim N(0,1)$，按以上分析，可适当选择常数k，当$ \frac{\overline{X}-\mu_{0}}{\sigma/\sqrt{n}}\geq k$时就拒绝$H_0$，为了确定k的值，令$$P\left\{ \frac{\overline{X}-\mu_{0}}{\sigma/\sqrt{n}}\geq k\right\}=\alpha,$$,则可求得$k=u_{\alpha/2}$。

若统计量u的观察值落在$|u|\geq u_{\alpha/2}$的范围内就拒绝$H_0$，否则就接受$H_0$。

本例中，$n=9,\sigma=0.5,\overline{x}=99.52,\mu_0=100,\alpha=0.05,u_{\alpha/2}=u_{0.025}=1.96$,从而有$$|u|=\frac{\overline{x}-\mu_{0}}{\sigma/\sqrt{n}}=2.88$$
由于$|u|=2.88>1.96$,因此拒绝$H_0:\mu=100$,即认为这批零件不合格。

由于检验法则是依据样本做出的，而抽取样本具有随机性，因此假设检验容易出现以下两种错误：

* 第一类错误：原假设实际上是正确的，但是我们做出的决定是拒绝原假设。

  * 只有小概率事件发生是才会出现第一类错误，其概率不超过显著性水平$\alpha$。

* 第二类错误：原假设实际上是不正确的，但是我们做出的决定是接受原假设，记其发生的概率为$\beta$。

如何避免这两种错误：

* 一般在固定样本容量的情况下，减少犯某一种错误的概率，然而另一种错误发生的概率会增加。只有在增加样本容量的情况下，才能使两种错误发生的概率减少。
  
* 在给定样本的情况下，我们总是控制第一类错误发生的概率，而不考虑犯第二种错误的概率，这种假设检验问题称为显著性假设。

**双边检验**

* 原假设$H_{0}:\theta=\theta_{0}$，对立假设为$H_{1}:\theta\neq\theta_{0}$。

**左边检验**

* 原假设$H_{0}:\theta\geq\theta_{0}$，对立假设为$H_{1}:\theta<\theta_{0}$。

**右边检验**

* 原假设$H_{0}:\theta\leq\theta_{0}$，对立假设为$H_{1}:\theta>\theta_{0}$。

左边检验与右边检验统称为单边检验。

<font size=4>**（3）假设检验的基本步骤**</font>

* 依据实际问题的需要，提出原假设$H_{0}$以及相应的对立假设$H_{1}$；

* 给出显著水平$\alpha$和样本容量 n；

* 确定检验统计量以及拒绝域形式；

* 按犯第一类错误的概率等于$\alpha$，求出拒绝域W；

* 依据样本观测值计算检验统计量的观测值作出决策，是拒绝原假设，还是接受原假设。

## 正态总体均值与方差的假设检验

### 单个正态总体情形

<font size=4>**（1）$\sigma$已知，关于$\mu$的假设检验: $u$检验**</font>

* 提出需要检验的假设:  $H_{0}: \mu=\mu_{0}; ~~~~H_{1}: \mu\neq\mu_{0}$

* 给出检验统计量:

$$\begin{aligned}
  u=\frac{\overline{X}-\mu_{0}}{\sigma/\sqrt{n}}\sim N(0,1);
  \end{aligned}\tag{8.1}$$
  
* 对于给定的显著水平$\alpha$，使得

$$P\left\{\frac{|\overline{X}-\mu_{0}|}{\sigma/\sqrt{n}}\geq u_{\frac{\alpha}{2}}\right\}=\alpha,\tag{8.2}$$ 因此得到的$H_{0}$的拒绝域为:$W=\{|u|\geq u_{\frac{\alpha}{2}}\}$.

* 依据样本观测值计算$u$，若$|u|\geq u_{\frac{\alpha}{2}}$就拒绝$H_{0}$，认为均值$\mu$和$\mu_{0}$有显著差异。反之，接受。


检验中所用统计量为
$$\begin{aligned}
u=\frac{\overline{X}-\mu_{0}}{\sigma/\sqrt{n}}\sim N(0,1)
\end{aligned}\tag{8.3}$$
称这类检验为$u$检验。

* 左边检验

  * 假设 $H_{0}: \mu=\mu_{0} (\mu\geq \mu_{0})$; $H_{1}: \mu<\mu_{0}$
  
  * 拒绝域 $W=\{u\leq -u_{\alpha}\}$

* 右边检验

  * 假设 $H_{0}: \mu=\mu_{0} (\mu\leq \mu_{0})$; $H_{1}: \mu>\mu_{0}$
  
  * 拒绝域 $W=\{u\geq u_{\alpha}\}$

**例3：**一种元件要求其平均寿命不小于1000h。现从一批这种元件中随机抽取25件，测得平均寿命为950h，已知这批元件寿命服从$\sigma=100h$的正态分布，试在显著性水平$\alpha=0.05$下确定这批元件是否合格。

<font size=4>**（2）$\sigma$未知，关于$\mu$的假设检验: $t$检验**</font>

* 提出需要检验的假设:  $H_{0}: \mu=\mu_{0}; ~~~~H_{1}: \mu\neq\mu_{0}$

* 给出检验统计量:

$$\begin{aligned}
  t=\frac{\overline{X}-\mu_{0}}{S/\sqrt{n}}\sim t(n-1);
  \end{aligned}\tag{8.4}$$
  
* 对于给定的显著水平$\alpha$，使得

$$P\left\{\frac{|\overline{X}-\mu_{0}|}{S/\sqrt{n}}\geq t_{\frac{\alpha}{2}}(n-1)\right\}=\alpha,\tag{8.5}$$ 因此得到的$H_{0}$的拒绝域为:$W=\{|t|\geq t_{\frac{\alpha}{2}}(n-1)\}$.

* 依据样本观测值计算$t$，若$|t|\geq t_{\frac{\alpha}{2}}(n-1)$就拒绝$H_{0}$，认为均值$\mu$和$\mu_{0}$有显著差异。反之，接受。


检验中所用统计量为
$$\begin{aligned}
t=\frac{\overline{X}-\mu_{0}}{S/\sqrt{n}}\sim t(n-1)
  \end{aligned}\tag{8.6}$$
称这类检验为$t$检验。

* 左边检验

  * 假设 $H_{0}: \mu=\mu_{0} (\mu\geq \mu_{0})$; $H_{1}: \mu<\mu_{0}$
  
  * 拒绝域 $W=\{t\leq -t_{\alpha}(n-1)\}$

* 右边检验

  * 假设 $H_{0}: \mu=\mu_{0} (\mu\leq \mu_{0})$; $H_{1}: \mu>\mu_{0}$
  
  * 拒绝域 $W=\{u\geq t_{\alpha}(n-1)\}$

**例4：**某车床加工一种零件，要求长度为150mm。今从一批加工后的这种零件中抽取9个，测得长度（单位：mm）如下：

<center>
  147 150 149 154 152 153 148 151 155
</center>

假设零件长度服从正态分布$X\sim N(\mu,\sigma^2)$，问这批零件是否合格（取$\alpha=0.05$)


<font size=4>**（3）$\mu$已知，关于$\sigma^{2}$的假设检验: $\chi^{2}$检验**</font>

* 提出需要检验的假设:  $H_{0}: \sigma^{2}=\sigma^{2}_{0}; ~~~~H_{1}: \sigma\neq\sigma^{2}_{0}$

* 给出检验统计量:

$$\begin{aligned}
  \chi^{2}=\frac{1}{\sigma^{2}_{0}}\sum_{i=1}^{n}(X_{i}-\mu)^{2}\sim \chi^{2}(n);
  \end{aligned}\tag{8.7}$$
  
* 对于给定的显著水平$\alpha$，使得

$$P\left\{\chi^{2}_{1-\alpha/2}(n)\leq \frac{1}{\sigma^{2}_{0}}\sum_{i=1}^{n}(X_{i}-\mu)^{2}\leq \chi^{2}_{\alpha/2}(n)\right\}=1-\alpha\tag{8.8}$$
  
* 拒绝域为

$$W=\{\chi^{2}\leq \chi^{2}_{1-\alpha/2}(n) \text{或} \chi^{2}\geq \chi^{2}_{\alpha/2}(n)\} \tag{8.9}$$


<font size=4>**（4）$\mu$未知，关于$\sigma^{2}$的假设检验: $\chi^{2}$检验**</font>

* 提出需要检验的假设:  $H_{0}: \sigma^{2}=\sigma^{2}_{0}; ~~~~H_{1}: \sigma\neq\sigma^{2}_{0}$

* 给出检验统计量:

$$\begin{aligned}
  \chi^{2}=\frac{(n-1)S^{2}}{\sigma^{2}_{0}}\sim \chi^{2}(n-1);
  \end{aligned}\tag{8.10}$$
  
* 对于给定的显著水平$\alpha$，使得

  $$P\left\{\chi^{2}_{1-\alpha/2}(n-1)\leq \frac{(n-1)S^{2}}{\sigma^{2}_{0}}\leq \chi^{2}_{\alpha/2}(n-1)\right\}=1-\alpha\tag{8.11}$$
  
* 拒绝域为

$$W=\{\chi^{2}\leq \chi^{2}_{1-\alpha/2}(n-1) \text{或} \chi^{2}\geq \chi^{2}_{\alpha/2}(n-1)\}\tag{8.12}$$

**例5：**某无线电厂生产的一种高频管，其中一项指标服从正态分布$X\sim N(\mu,\sigma^2)$，从一批产品中抽取8只管子，测得该指标数据如下：

<center>
  68 43 70 62 55 56 60 72
</center>

（1）当$\mu=60$时，检验$\sigma^2=8^2$(取$\alpha=0.05$)；

（2）当$\mu$未知时，检验$\sigma^2=8^2$(取$\alpha=0.05$)。

### 两个正态总体情形

<font size=4>**（1）假设与记号**</font>

假设总体$X\sim N(\mu_{1},\sigma_{1}^{2})$， 总体$Y\sim N(\mu_{2},\sigma_{2}^{2})$，并且这两个正态总体相互独立。样本$(X_{1},X_{2},\cdots,X_{n})$与$(Y_{1},Y_{2},\cdots,Y_{n})$分别来自总体X与Y，他们相互独立，其样本均值与样本方差为
$$\overline{X}=\frac{1}{n_{1}}\sum_{i=1}^{n_{1}}x_{i}, ~~~~\overline{Y}=\frac{1}{n_{2}}\sum_{i=1}^{n_{2}}y_{i},\tag{8.13}$$
$$S_{1}^{2}=\frac{1}{n_{1}-1}\sum_{i=1}^{n_{1}}(X_{i}-\overline{X})^{2},~~~~S_{2}^{2}=\frac{1}{n_{2}-1}\sum_{i=1}^{n_{2}}(Y_{i}-\overline{Y})^{2}\tag{8.14}$$


<font size=4>**（2）$\sigma_{1}^{2}$与$\sigma_{2}^{2}$已知，均值差$\mu_{1}-\mu_{2}$的假设检验**</font>

* 提出需要检验的假设:  $H_{0}: \mu_{1}-\mu_{2}=\delta; ~~~~H_{1}: \mu_{1}-\mu_{2}\neq\delta$

* 给出检验统计量:

$$\begin{aligned}
  u=\frac{\overline{X}-\overline{Y}-\delta}{\sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}}\sim N(0,1);
  \end{aligned}\tag{8.15}$$
  
* 对于给定的显著水平$\alpha$，使得

  $$P\left\{\frac{\overline{X}-\overline{Y}-\delta}{\sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}}\geq u_{\alpha/2}\right\}=\alpha \tag{8.16}$$
  
* 拒绝域为$$W=\{|u|\geq u_{\alpha/2}\}$$

**例6：**设总体$X\sim N(\mu_1,{10}^2)$,从总体X中抽取容量为5的样本，其观测值为

<center>
  21.0 20.5 19.5 20.5 19.0
</center>

设总体$Y\sim N(\mu_2,{9}^2)$,从总体Y中抽取容量为4的样本，其观测值为

<center>
  20.0 20.5 21.0 19.5
</center>

试在显著性水平$\alpha=0.05$下检验两个总体的均值是否相等。


<font size=4>**（3）$\sigma_{1}^{2}=\sigma_{2}^{2}=\sigma$未知，均值差$\mu_{1}-\mu_{2}$的假设检验**</font>

* 提出需要检验的假设:  $H_{0}: \mu_{1}-\mu_{2}=\delta; ~~~~H_{1}: \mu_{1}-\mu_{2}\neq\delta$

* 给出检验统计量:

$$\begin{aligned}
  T=\frac{\overline{X}-\overline{Y}-\delta}{\frac{(n_{1}-1)S_{1}^{2}+(n_{2}-1)S_{2}^{2}}{n_{1}+n_{2}-2}\sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}}\sim t(n_{1}+n_{2}-2);
  \end{aligned}\tag{8.17}$$
  
* 对于给定的显著水平$\alpha$，使得

  $$P\left\{|T|\geq t_{\alpha/2}(n_{1}+n_{2}-2)\right\}=\alpha\tag{8.18}$$
  
* 拒绝域为

$$W=\{|t|\geq t_{\alpha/2}(n_{1}+n_{2}-2)\}\tag{8.19}$$


**例7：**在甲乙两个工厂生产的蓄电池中，分别抽取5个测量蓄电池的电容量，数据如下：

|甲厂|143|141|138|142|140|
|:--:|:-:|:-:|:-:|:-:|:-:|
|乙厂|141|143|139|144|141|

设甲厂和乙厂生产的蓄电池的电容量分别服从正态分布$N(\mu_1,\sigma_1^2)$,$N(\mu_2,\sigma_2^2)$，且$\sigma_1^2=\sigma_2^2$，问两厂蓄电池的电容量有无显著差异？（取$\alpha=0.05$)


<font size=4>**（4）均值$\mu_{1}$与$\mu_{2}$已知，方差比$\sigma_{1}^{2}/\sigma_{2}^{2}$的假设检验**</font>

* 要检验假设 $H_{0}: \sigma_{1}^{2}=\sigma^{2}_{2}; ~~~~H_{1}: \sigma_{1}^{2}\neq\sigma^{2}_{2}$

* 给出检验统计量:

$$\begin{aligned}
  F=\frac{n_{2}\sum_{i=1}^{n_{1}}(X_{i}-\mu_{1})^{2}}{n_{1}\sum_{i=1}^{n_{2}}(Y_{i}-\mu_{2})^{2}}\sim F(n_{1},n_{2}).
  \end{aligned}\tag{8.20}$$
  
* 对于给定的显著水平$\alpha$，使得

$$P\{F\leq F_{1-\alpha/2}(n_{1},n_{2}) \text{或} F\geq F_{\alpha/2}(n_{1},n_{2})\}=\alpha\tag{8.21}$$

* 拒绝域为

$$W=\{F\leq F_{1-\alpha/2}(n_{1},n_{2}) \text{或} F\geq F_{\alpha/2}(n_{1},n_{2})\}\tag{8.22}$$


<font size=4>**（5）均值$\mu_{1}$与$\mu_{2}$未知，方差比$\sigma_{1}^{2}/\sigma_{2}^{2}$的假设检验**</font>

* 要检验假设 $H_{0}: \sigma_{1}^{2}=\sigma^{2}_{2}; ~~~~H_{1}: \sigma_{1}^{2}\neq\sigma^{2}_{2}$

* 给出检验统计量:

$$\begin{aligned}
  F=\frac{S_{1}^{2}}{S_{2}^{2}}\sim F(n_{1}-1,n_{2}-1).
  \end{aligned}\tag{8.23}$$
  
* 对于给定的显著水平$\alpha$，使得

$$P\{F\leq F_{1-\alpha/2}(n_{1}-1,n_{2}-1) \text{或} F\geq F_{\alpha/2}(n_{1}-1,n_{2}-1)\}=\alpha\tag{8.24}$$
* 拒绝域为

$$W=\{F\leq F_{1-\alpha/2}(n_{1}-1,n_{2}-1) \text{或} F\geq F_{\alpha/2}(n_{1}-1,n_{2}-1)\}\tag{8.25}$$


**例8：**假设两批电子元件的电阻值分别服从正态分布$N(\mu_1,\sigma_1^2)$,$N(\mu_2,\sigma_2^2)$，分别独立抽取样本，测得电阻值（$\Omega$）为

|A批|0.140|0.138|0.143|0.142|0.144|0.137|
|:--:|:-:|:-:|:-:|:-:|:-:|:-:|
|B批|0.135|0.140|0.142|0.136|0.138|0.140|

问这两批电子元件的电阻是否有显著差异（取$\alpha=0.05$）

**例9：**甲乙两台机床生产同一型号的滚珠，先从这两台机床的产品中分别独立抽取8个和9个，测得滚珠直径如下：

|甲机床|15.0|14.5|15.2|15.5|14.8|15.1|15.2|14.8|
|:--:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|乙机床|15.2|15.0|14.8|15.2|15.0|14.8|15.1|14.8|

假设滚珠直径服从正态分布，问乙机床的加工精度是否比甲机床高？（取$\alpha=0.05$）
